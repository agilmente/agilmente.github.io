(self.webpackChunkagilmente_cp=self.webpackChunkagilmente_cp||[]).push([[1895],{1895:(i,n,e)=>{"use strict";e.r(n),e.d(n,{SpecificPlanningPageModule:()=>z});var t=e(1116),a=e(1462),o=e(5527),s=e(6611),r=e(5860),l=e(4762),c=e(9609),m=e.n(c),u=e(8619),g=e(5450),p=e(9723),d=e(3404),h=e(9310);function Z(i,n){if(1&i){const i=u.EpF();u.TgZ(0,"ion-item"),u.TgZ(1,"ion-button",27),u.NdJ("click",function(){const n=u.CHM(i).$implicit;return u.oxw().fillSearchBar(n.firstName+" "+n.lastName)}),u.TgZ(2,"ion-text"),u._uU(3),u.qZA(),u.qZA(),u.qZA()}if(2&i){const i=n.$implicit;u.xp6(3),u.AsE(" ",i.firstName," ",i.lastName," ")}}function f(i,n){1&i&&(u.TgZ(0,"ion-label",28),u._uU(1,"El paciente ingresado no existe"),u.qZA())}function x(i,n){if(1&i&&(u.TgZ(0,"ion-chip",29),u._UZ(1,"ion-icon",30),u.TgZ(2,"ion-label",29),u._uU(3),u.qZA(),u.qZA()),2&i){const i=u.oxw();u.xp6(3),u.Oqu(i.state)}}function A(i,n){if(1&i&&(u.TgZ(0,"ion-chip",31),u._UZ(1,"ion-icon",32),u.TgZ(2,"ion-label"),u._uU(3),u.qZA(),u.qZA()),2&i){const i=u.oxw();u.xp6(3),u.Oqu(i.state)}}function b(i,n){if(1&i&&(u.TgZ(0,"p"),u.TgZ(1,"b"),u._uU(2,"Sesiones: "),u.qZA(),u._uU(3),u.qZA()),2&i){const i=u.oxw().$implicit;u.xp6(3),u.Oqu(i.numberOfSession)}}function q(i,n){1&i&&(u.TgZ(0,"p"),u.TgZ(1,"b"),u._uU(2,"Sesiones: "),u.qZA(),u._uU(3,"Sin l\xedmite de sesiones."),u.qZA())}function v(i,n){if(1&i&&(u.TgZ(0,"div"),u.TgZ(1,"p"),u.TgZ(2,"b"),u._uU(3),u.qZA(),u._uU(4,"Si"),u.qZA(),u.qZA()),2&i){const i=u.oxw().$implicit;u.xp6(3),u.hij("",null==i?null:i.spanishName,": ")}}function T(i,n){if(1&i&&(u.TgZ(0,"div"),u.TgZ(1,"p"),u.TgZ(2,"b"),u._uU(3),u.qZA(),u._uU(4,"No"),u.qZA(),u.qZA()),2&i){const i=u.oxw().$implicit;u.xp6(3),u.hij("",null==i?null:i.spanishName,": ")}}function N(i,n){if(1&i&&(u.TgZ(0,"div"),u.TgZ(1,"p"),u.TgZ(2,"b"),u._uU(3),u.qZA(),u._uU(4,"Flores"),u.qZA(),u.qZA()),2&i){const i=u.oxw(3).$implicit;u.xp6(3),u.hij("",null==i?null:i.spanishName,": ")}}function w(i,n){if(1&i&&(u.TgZ(0,"div"),u.TgZ(1,"p"),u.TgZ(2,"b"),u._uU(3),u.qZA(),u._uU(4,"Frutas"),u.qZA(),u.qZA()),2&i){const i=u.oxw(3).$implicit;u.xp6(3),u.hij("",null==i?null:i.spanishName,": ")}}function J(i,n){if(1&i&&(u.TgZ(0,"div"),u.YNc(1,N,5,1,"div",24),u.YNc(2,w,5,1,"div",24),u.qZA()),2&i){const i=u.oxw(2).$implicit;u.xp6(1),u.Q6J("ngIf","1"==(null==i?null:i.value)),u.xp6(1),u.Q6J("ngIf","2"==(null==i?null:i.value))}}function S(i,n){if(1&i&&(u.TgZ(0,"p"),u.TgZ(1,"b"),u._uU(2),u.qZA(),u._uU(3),u.qZA()),2&i){const i=u.oxw(2).$implicit;u.xp6(2),u.hij("",null==i?null:i.spanishName,": "),u.xp6(1),u.Oqu(null==i?null:i.value)}}function C(i,n){if(1&i&&(u.TgZ(0,"div"),u.YNc(1,J,3,2,"div",39),u.YNc(2,S,4,2,"ng-template",null,40,u.W1O),u.qZA()),2&i){const i=u.MAs(3),n=u.oxw().$implicit;u.xp6(1),u.Q6J("ngIf","spriteSet"==(null==n?null:n.name))("ngIfElse",i)}}function y(i,n){if(1&i&&(u.TgZ(0,"ion-label"),u.TgZ(1,"div",36),u.YNc(2,v,5,1,"div",37),u.YNc(3,T,5,1,"div",37),u.YNc(4,C,4,2,"div",38),u.qZA(),u.qZA()),2&i){const i=n.$implicit;u.xp6(1),u.Q6J("ngSwitch",null==i?null:i.value),u.xp6(1),u.Q6J("ngSwitchCase","true"),u.xp6(1),u.Q6J("ngSwitchCase","false")}}function I(i,n){if(1&i&&(u.TgZ(0,"ion-card",34),u.TgZ(1,"ion-card-header"),u.TgZ(2,"ion-row"),u.TgZ(3,"ion-card-title",35),u._uU(4),u.qZA(),u.qZA(),u.qZA(),u.TgZ(5,"ion-card-content"),u.YNc(6,b,4,1,"p",24),u.YNc(7,q,4,0,"p",24),u.YNc(8,y,5,3,"ion-label",15),u.qZA(),u.qZA()),2&i){const i=n.$implicit;u.xp6(4),u.Oqu(i.game),u.xp6(2),u.Q6J("ngIf",-1!=i.numberOfSession),u.xp6(1),u.Q6J("ngIf",-1==i.numberOfSession),u.xp6(1),u.Q6J("ngForOf",null==i?null:i.parameters)}}function O(i,n){if(1&i&&(u.TgZ(0,"div"),u.YNc(1,I,9,4,"ion-card",33),u.qZA()),2&i){const i=u.oxw();u.xp6(1),u.Q6J("ngForOf",i.planningList)}}function k(i,n){1&i&&u._UZ(0,"ion-icon",46)}function F(i,n){1&i&&u._UZ(0,"ion-icon",47)}function U(i,n){if(1&i){const i=u.EpF();u.TgZ(0,"div"),u.TgZ(1,"ion-item"),u.TgZ(2,"ion-label"),u._uU(3),u.qZA(),u.TgZ(4,"ion-radio",53),u.NdJ("click",function(){u.CHM(i);const n=u.oxw(),e=n.$implicit,t=n.index,a=u.oxw(2).$implicit;return u.oxw().setActiveParam(a,e,t)}),u.qZA(),u.qZA(),u.TgZ(5,"ion-item",50),u.TgZ(6,"ion-label",12),u._uU(7,"Valor"),u.qZA(),u.TgZ(8,"ion-input",54),u.NdJ("ionChange",function(n){u.CHM(i);const e=u.oxw().$implicit,t=u.oxw(2).$implicit;return u.oxw().changeParamValue(t,e,n)})("ionBlur",function(){u.CHM(i);const n=u.oxw().$implicit;return u.oxw(3).checkParamLimit(n)}),u.qZA(),u.qZA(),u.qZA()}if(2&i){const i=u.oxw(),n=i.$implicit,e=i.index,t=u.oxw(3);u.xp6(3),u.Oqu(n.param.name),u.xp6(1),u.Q6J("value",e),u.xp6(1),u.s9C("disabled",!n.isActive),u.xp6(3),u.s9C("disabled",!n.isActive),u.s9C("value",n.value),u.Q6J("min",n.minValue)("max",t.checkMaxValue(n))}}function P(i,n){if(1&i){const i=u.EpF();u.TgZ(0,"div"),u.TgZ(1,"ion-item"),u.TgZ(2,"ion-text"),u._uU(3),u.qZA(),u.TgZ(4,"ion-item",55),u.TgZ(5,"ion-input",56),u.NdJ("ionChange",function(n){u.CHM(i);const e=u.oxw().$implicit,t=u.oxw(2).$implicit;return u.oxw().changeParamValue(t,e,n)})("ionBlur",function(){u.CHM(i);const n=u.oxw().$implicit;return u.oxw(3).checkParamLimit(n)}),u.qZA(),u.qZA(),u.qZA(),u.qZA()}if(2&i){const i=u.oxw().$implicit,n=u.oxw(3);u.xp6(3),u.Oqu(i.param.name),u.xp6(2),u.s9C("value",i.value),u.Q6J("min",i.minValue)("max",n.checkMaxValue(i))}}function _(i,n){if(1&i&&(u.TgZ(0,"div"),u.YNc(1,U,9,7,"div",24),u.YNc(2,P,6,4,"div",24),u.qZA()),2&i){const i=n.$implicit;u.xp6(1),u.Q6J("ngIf",0==i.param.type),u.xp6(1),u.Q6J("ngIf",3==i.param.type)}}function D(i,n){if(1&i){const i=u.EpF();u.TgZ(0,"div"),u.TgZ(1,"ion-item"),u.TgZ(2,"ion-label"),u._uU(3),u.qZA(),u.TgZ(4,"ion-toggle",49),u.NdJ("ionChange",function(n){u.CHM(i);const e=u.oxw().$implicit,t=u.oxw(2).$implicit;return u.oxw().changeParamsType1(t,e,n)}),u.qZA(),u.qZA(),u.qZA()}if(2&i){const i=u.oxw().$implicit;u.xp6(3),u.Oqu(i.param.name),u.xp6(1),u.s9C("checked",i.value)}}function G(i,n){if(1&i){const i=u.EpF();u.TgZ(0,"div"),u.TgZ(1,"ion-item"),u.TgZ(2,"ion-label"),u._uU(3),u.qZA(),u.TgZ(4,"ion-radio",53),u.NdJ("click",function(){const n=u.CHM(i).$implicit;return u.oxw(2).$implicit.value=n.id}),u.qZA(),u.qZA(),u.qZA()}if(2&i){const i=n.$implicit,e=n.index;u.xp6(3),u.Oqu(i.name),u.xp6(1),u.Q6J("value",e)}}function L(i,n){if(1&i&&(u.TgZ(0,"div"),u.TgZ(1,"ion-list-header"),u.TgZ(2,"ion-label"),u._uU(3),u.qZA(),u.qZA(),u.TgZ(4,"ion-radio-group",48),u.YNc(5,G,5,2,"div",15),u.qZA(),u.qZA()),2&i){const i=u.oxw().$implicit;u.xp6(3),u.hij(" ",i.param.name," "),u.xp6(1),u.Q6J("value",i.value-1),u.xp6(1),u.Q6J("ngForOf",i.paramType2Content)}}function E(i,n){if(1&i&&(u.TgZ(0,"div"),u.YNc(1,D,5,2,"div",24),u.YNc(2,L,6,3,"div",24),u.qZA()),2&i){const i=n.$implicit;u.xp6(1),u.Q6J("ngIf",1==i.param.type),u.xp6(1),u.Q6J("ngIf",2==i.param.type)}}function Y(i,n){if(1&i){const i=u.EpF();u.TgZ(0,"ion-card-content"),u.TgZ(1,"ion-list"),u.TgZ(2,"ion-list-header"),u.TgZ(3,"ion-label"),u._uU(4," Condici\xf3n de Parada "),u.qZA(),u.qZA(),u.TgZ(5,"ion-radio-group",48),u.YNc(6,_,3,2,"div",15),u.qZA(),u.TgZ(7,"ion-list-header"),u.TgZ(8,"ion-label"),u._uU(9," Activables "),u.qZA(),u.qZA(),u.YNc(10,E,3,2,"div",15),u.TgZ(11,"ion-item"),u.TgZ(12,"ion-label"),u._uU(13,"\xbfRepeticiones limitadas?"),u.qZA(),u.TgZ(14,"ion-toggle",49),u.NdJ("ionChange",function(){u.CHM(i);const n=u.oxw().$implicit;return n.hasLimit=!n.hasLimit}),u.qZA(),u.TgZ(15,"ion-item",50),u.TgZ(16,"ion-label",12),u._uU(17,"Cantidad"),u.qZA(),u.TgZ(18,"ion-input",51),u.NdJ("ionChange",function(n){u.CHM(i);const e=u.oxw().$implicit;return u.oxw().changeLimitGamesValue(e,n)})("ionBlur",function(){u.CHM(i);const n=u.oxw().$implicit;return u.oxw().checkMNoSLimit(n)}),u.qZA(),u.qZA(),u.qZA(),u.qZA(),u.TgZ(19,"ion-button",52),u.NdJ("click",function(){u.CHM(i);const n=u.oxw(),e=n.$implicit,t=n.index;return u.oxw().gameAdded(e,t)}),u._uU(20," Listo "),u.qZA(),u.qZA()}if(2&i){const i=u.oxw().$implicit,n=u.oxw();u.xp6(5),u.Q6J("value",i.index),u.xp6(1),u.Q6J("ngForOf",i.gameParam),u.xp6(4),u.Q6J("ngForOf",i.gameParam),u.xp6(4),u.s9C("checked",i.hasLimit),u.xp6(1),u.s9C("disabled",!i.hasLimit),u.xp6(3),u.s9C("disabled",!i.hasLimit),u.s9C("value",i.maxNumberOfSessions),u.xp6(1),u.Q6J("disabled",!n.checkIfCorrect(i))}}function Q(i,n){if(1&i){const i=u.EpF();u.TgZ(0,"ion-card"),u.TgZ(1,"ion-card-header",0),u.TgZ(2,"ion-row"),u.TgZ(3,"ion-col"),u.TgZ(4,"h4"),u._uU(5),u.qZA(),u.qZA(),u.TgZ(6,"ion-col",41),u.TgZ(7,"ion-button",42),u.NdJ("click",function(){const i=n.$implicit;return i.accordion=!i.accordion}),u.YNc(8,k,1,0,"ion-icon",43),u.YNc(9,F,1,0,"ion-icon",44),u.qZA(),u.TgZ(10,"ion-button",45),u.NdJ("click",function(){const n=u.CHM(i).$implicit;return u.oxw().deleteGame(n)}),u._UZ(11,"ion-icon",6),u.qZA(),u.qZA(),u.qZA(),u.qZA(),u.YNc(12,Y,21,8,"ion-card-content",24),u.qZA()}if(2&i){const i=n.$implicit;u.xp6(5),u.hij(" ",i.name," "),u.xp6(3),u.Q6J("ngIf",!i.accordion),u.xp6(1),u.Q6J("ngIf",i.accordion),u.xp6(3),u.Q6J("ngIf",i.accordion)}}function $(i,n){if(1&i){const i=u.EpF();u.TgZ(0,"ion-item"),u.TgZ(1,"ion-button",27),u.NdJ("click",function(){const n=u.CHM(i).$implicit;return u.oxw(2).addGame(n)}),u.TgZ(2,"ion-text"),u._uU(3),u.qZA(),u.qZA(),u.qZA()}if(2&i){const i=n.$implicit;u.xp6(3),u.hij(" ",i.name," ")}}function M(i,n){if(1&i){const i=u.EpF();u.TgZ(0,"div"),u.TgZ(1,"ion-label",12),u._uU(2,"Juego"),u.qZA(),u.TgZ(3,"ion-searchbar",57),u.NdJ("ionInput",function(n){return u.CHM(i),u.oxw().filterGame(n)}),u.qZA(),u.TgZ(4,"ion-list",14),u.YNc(5,$,4,1,"ion-item",15),u.qZA(),u.qZA()}if(2&i){const i=u.oxw();u.xp6(5),u.Q6J("ngForOf",i.gamesSearch)}}function V(i,n){if(1&i){const i=u.EpF();u.TgZ(0,"ion-button",58),u.NdJ("click",function(){return u.CHM(i),u.oxw().isAdding=!0}),u._UZ(1,"ion-icon",59),u.TgZ(2,"ion-label",7),u._uU(3,"A\xf1adir Juego"),u.qZA(),u.qZA()}}function B(i,n){if(1&i&&(u.TgZ(0,"ion-button",60),u._uU(1," Actualizar Planificaci\xf3n "),u.qZA()),2&i){const i=u.oxw();u.Q6J("disabled",i.submitDisabled())}}const H=[{path:"",component:(()=>{class i{constructor(i,n,e,t,a,o,s,r){this.patientsApiService=i,this.gamesApiService=n,this.planningApiService=e,this.modalCtrl=t,this.alertController=a,this.router=o,this.route=s,this.dialogsComponent=r,this.datePickerStart={},this.datePickerFinish={},this.assignedGames=[],this.planningGames=[],this.auxGames=[],this.games=[],this.isAdding=!1,this.patientBlur=!1,this.isEditing=!1}ngOnInit(){this.route.params.subscribe(i=>{this.id=+i.id}),this.patientsApiService.getPatientsListed().subscribe(i=>{this.patients=i});let i=0;this.gamesApiService.getGames().subscribe(n=>{n.forEach(n=>{this.games.push(n),this.games[i].gameParam.forEach(i=>{i.isActive=!1,1==i.param.type&&(i.value=!1),2==i.param.type&&(i.value=1),3==i.param.type&&(i.value=((i.minValue+i.maxValue)/2).toFixed(0))}),this.games[i].maxNumberOfSessions=5,this.games[i].hasLimit=!1,this.games[i].index=null,this.games[i].done=!0,i++})}),this.datePickerStart={showTodayButton:!1,closeOnSelect:!0,setLabel:"Ok",closeLabel:"Cerrar",titleLabel:"Selecciona una fecha",dateFormat:"DD-MM-YYYY",clearButton:!1,monthsList:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],weeksList:["D","L","M","X","J","V","S"],fromDate:new Date,inputDate:new Date},this.datePickerFinish={showTodayButton:!1,closeOnSelect:!0,setLabel:"Ok",closeLabel:"Cerrar",titleLabel:"Selecciona una fecha",dateFormat:"DD-MM-YYYY",clearButton:!1,monthsList:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],weeksList:["D","L","M","X","J","V","S"]},this.myForm=new a.cw({patient:new a.NI("",a.kI.required),planningName:new a.NI(""),startDate:new a.NI("",a.kI.required),finishDate:new a.NI("",a.kI.required),games:new a.NI("",a.kI.required)}),this.myForm.patchValue({games:null}),this.loadPlanning()}patientExists(){var i;let n=!1;return null===(i=this.patients)||void 0===i||i.forEach(i=>{i.firstName.toLowerCase()+" "+i.lastName.toLowerCase()==this.myForm.value.patient.toLowerCase()&&(n=!0)}),n}setFinishMinDate(){var i=this.myForm.value.startDate.split("-");let n=new Date(parseInt(i[2]),parseInt(i[1])-1,parseInt(i[0])+1);this.datePickerFinish.fromDate=n,this.datePickerFinish.inputDate=n,this.myForm.patchValue({finishDate:n}),this.myForm.patchValue({finishDate:m()(n).format("DD-MM-YYYY")})}filterPatient(i){return(0,l.mG)(this,void 0,void 0,function*(){const n=i.srcElement.value;this.patientsSearch=this.patients.filter(i=>{if(n&&this.patientsSearch)return(i.firstName.toLowerCase()+" "+i.lastName.toLowerCase()).indexOf(n.toLowerCase())>-1})})}filterGame(i){return(0,l.mG)(this,void 0,void 0,function*(){const n=i.srcElement.value;this.gamesSearch=this.games.filter(i=>{if(n&&this.gamesSearch)return i.name.toLowerCase().indexOf(n.toLowerCase())>-1})})}openDatePicker(){return(0,l.mG)(this,void 0,void 0,function*(){const i=yield this.modalCtrl.create({component:o.Fd,cssClass:"li-ionic4-datePicker"});yield i.present()})}fillSearchBar(i){this.myForm.patchValue({patient:i}),this.patientsSearch=null}addGame(i){this.gamesSearch=[],this.planningGames.push(JSON.parse(JSON.stringify(i))),this.planningGames[this.planningGames.length-1].accordion=!0,this.isAdding=!1,this.myForm.patchValue({games:null})}setActiveParam(i,n,e){i.index=e,i.gameParam.forEach(i=>{i.id==n.id?i.isActive||(i.isActive=!0):i.isActive=!1})}changeParamValue(i,n,e){let t=this.planningGames[this.planningGames.indexOf(i)];t.gameParam[t.gameParam.indexOf(n)].isActive&&(t.gameParam[t.gameParam.indexOf(n)].value=e.srcElement.value)}changeLimitGamesValue(i,n){this.planningGames[this.planningGames.indexOf(i)].maxNumberOfSessions=n.srcElement.value}changeParamsType1(i,n,e){let t=this.planningGames[this.planningGames.indexOf(i)];t.gameParam[t.gameParam.indexOf(n)].value=!t.gameParam[t.gameParam.indexOf(n)].value}checkIfCorrect(i){let n=!1;return i.gameParam.forEach(i=>{0==i.param.type?i.isActive&&i.value&&(n=!0):i.isActive=!0}),n&&this.assignedGames.forEach(e=>{JSON.stringify(e.gameParam)==JSON.stringify(i.gameParam)&&e.name==i.name&&i.hasLimit==e.hasLimit&&i.maxNumberOfSessions==e.maxNumberOfSessions&&(n=!1)}),n}deleteGame(i){let n=this.planningGames.indexOf(i);this.planningGames.splice(n,1),this.assignedGames[n]&&this.assignedGames.splice(n,1)}checkMaxValue(i){return i.maxValue<=-1?void 0:i.maxValue}checkParamLimit(i){parseInt(i.value)<i.minValue&&(i.value=i.minValue.toString()),-1!=i.maxValue&&parseInt(i.value)>i.maxValue&&(i.value=i.maxValue.toString())}checkMNoSLimit(i){parseInt(i.maxNumberOfSessions)<1&&(i.maxNumberOfSessions="1")}gameAdded(i,n){i.accordion=!1,i.done?this.assignedGames[n]=JSON.parse(JSON.stringify(i)):(i.done=!0,this.assignedGames.push(JSON.parse(JSON.stringify(i))))}presentAlert(i,n,e,t){return(0,l.mG)(this,void 0,void 0,function*(){const a=yield this.alertController.create({message:n,header:"Editar Planificaci\xf3n",subHeader:i,cssClass:"centerh3",buttons:[{text:"OK",cssClass:t}]});yield a.present(),(yield a.onDidDismiss())&&e&&this.router.navigateByUrl("/planning")})}edit(i){let n;this.patients.forEach(i=>{i.firstName.toLowerCase()+" "+i.lastName.toLowerCase()==this.myForm.value.patient.toLowerCase()&&(n=i.id)});let e=[];if(this.assignedGames.forEach(i=>{let n={gameId:i.id,maxNumberOfSessions:i.hasLimit?i.maxNumberOfSessions:-1,params:void 0},t={};i.gameParam.forEach(i=>{if(i.isActive){let n={[i.param.className]:i.value};t=Object.assign(Object.assign({},t),n)}}),n.params=t,e.push(n)}),i.valid){let t={patientId:n,stateId:1,professionalId:1,planningName:i.value.planningName,startDate:i.value.startDate,dueDate:i.value.finishDate,games:e};this.planningApiService.cancelPlanningById(this.id).subscribe(i=>{this.planningApiService.postPlanning(t).subscribe(i=>{this.presentAlert("\xa1Planificaci\xf3n Editada!","<p>La planificaci\xf3n ha sido editada correctamente. </p>",!0,"alertSuccess")},i=>{this.presentAlert("Error","Un error ha ocurrido, por favor int\xe9ntelo de nuevo m\xe1s tarde.",!1,"alertError")})},i=>{this.presentAlert("Error","Un error ha ocurrido, por favor int\xe9ntelo de nuevo m\xe1s tarde.",!1,"alertError")})}}submitDisabled(){let i=!0;return 0==this.planningGames.length&&(i=!1),this.planningGames.forEach(n=>{n.done||(i=!1)}),this.myForm.patchValue(i&&this.assignedGames.length>0?{games:"ok"}:{games:null}),!this.myForm.valid||!this.patientExists()||JSON.stringify(this.assignedGames)==JSON.stringify(this.auxGames)&&this.planningName==this.myForm.value.planningName&&this.auxFinishDate==this.myForm.value.finishDate&&this.auxStartDate==this.myForm.value.startDate}loadPlanning(){this.planningApiService.getPlanningById(this.id).subscribe(i=>{this.patientId=i.patientId,this.planningName=i.planningName,this.state=i.stateName,this.planningList=i.planningList,this.myForm.setValue({patient:i.patientFirstName+" "+i.patientLastName,planningName:i.planningName,startDate:i.startDate,finishDate:i.dueDate,games:null}),this.auxStartDate=i.startDate,this.auxFinishDate=i.dueDate})}cancelPlanning(){return(0,l.mG)(this,void 0,void 0,function*(){(yield this.dialogsComponent.presentAlertConfirm("Planificaci\xf3n","\xbfDesea cancelar la planificaci\xf3n? Esta acci\xf3n no puede deshacerse"))&&this.planningApiService.cancelPlanningById(this.id).subscribe(i=>{this.dialogsComponent.presentAlert("Planificaci\xf3n eliminada","","<p>La planificaci\xf3n ha sido eliminado correctamente.","/planning")},i=>{this.dialogsComponent.presentAlert("Error","","Un error ha ocurrido, por favor int\xe9ntelo de nuevo m\xe1s tarde.","/planning")})})}editPlanning(){this.isEditing=!0;for(let t=0;t<this.planningList.length;t++){this.assignedGames.push(JSON.parse(JSON.stringify(this.games.find(i=>i.name==this.planningList[t].game))));let i=1;this.assignedGames[t].gameParam.forEach(n=>{let e=this.planningList[t].parameters.find(i=>i.spanishName==n.param.name);e&&(0==n.param.type&&1==n.param.id&&(i=0),n.isActive=!0,n.value=!isNaN(parseFloat(e.value))&&isFinite(e.value)?Math.floor(e.value).toString():"false"!=e.value&&("true"==e.value||e.value))}),this.assignedGames[t].index=i,this.assignedGames[t].done=!0,this.assignedGames[t].accordion=!1,this.planningList[t].numberOfSession>0?(this.assignedGames[t].maxNumberOfSessions=this.planningList[t].numberOfSession,this.assignedGames[t].hasLimit=!0):(this.assignedGames[t].maxNumberOfSessions=5,this.assignedGames[t].hasLimit=!1)}var i=this.myForm.value.startDate.split("-");let n=new Date(parseInt(i[2]),parseInt(i[1])-1,parseInt(i[0])+1),e=new Date;this.datePickerFinish.fromDate=e>n?e:n,this.planningGames=JSON.parse(JSON.stringify(this.assignedGames)),this.auxGames=JSON.parse(JSON.stringify(this.assignedGames))}}return i.\u0275fac=function(n){return new(n||i)(u.Y36(g.M),u.Y36(p.J),u.Y36(d.e),u.Y36(s.IN),u.Y36(s.Br),u.Y36(r.F0),u.Y36(r.gz),u.Y36(h.T))},i.\u0275cmp=u.Xpm({type:i,selectors:[["app-specific-planning"]],decls:62,vars:17,consts:[["color","primary"],["slot","start"],["text",""],["size","2"],[1,"ion-padding","ion-margin"],["color","danger","fill","clear",2,"float","right",3,"click"],["name","trash-outline"],[1,"ion-margin"],["fill","clear",2,"float","right",3,"disabled","click"],["name","pencil-outline"],[3,"formGroup","ngSubmit"],["id","rounded"],["position","stacked","color","primary"],["animated","","placeholder","Selecciona un paciente","formControlName","patient",3,"disabled","ionInput","ionFocus","ionBlur"],["lines","none"],[4,"ngFor","ngForOf"],["color","danger","style","margin-left: 5%;font-size: 80%;",4,"ngIf"],["formControlName","planningName",3,"disabled"],["id","rounded","button",""],["readonly","","formControlName","startDate",3,"liIonic4Datepicker","disabled","ionChange"],["name","calendar-outline","slot","end",2,"margin-top","16px"],["readonly","","formControlName","finishDate",3,"liIonic4Datepicker","disabled"],["color","dark",4,"ngIf"],["color","warning",4,"ngIf"],[4,"ngIf"],["style","float: right;",3,"click",4,"ngIf"],["type","submit","expand","block","class","ion-text-uppercase ion-margin-top",3,"disabled",4,"ngIf"],["fill","clear",1,"ion-text-wrap",3,"click"],["color","danger",2,"margin-left","5%","font-size","80%"],["color","dark"],["color","success","name","checkmark-circle"],["color","warning"],["name","close-circle"],["class","horizontal-cards",4,"ngFor","ngForOf"],[1,"horizontal-cards"],["color","primary",2,"margin-top","0.8%"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[4,"ngIf","ngIfElse"],["notSpriteSet",""],["size","3"],["fill","clear",2,"float","right",3,"click"],["name","chevron-down-outline","color","light",4,"ngIf"],["name","chevron-up-outline","color","light",4,"ngIf"],["color","danger",2,"float","right","--border-radius","20px",3,"click"],["name","chevron-down-outline","color","light"],["name","chevron-up-outline","color","light"],[3,"value"],[3,"checked","ionChange"],[3,"disabled"],["type","number","min","1",3,"disabled","value","ionChange","ionBlur"],["expand","block",1,"ion-text-uppercase","ion-margin-top",3,"disabled","click"],[3,"value","click"],["type","number","type","number",3,"disabled","value","min","max","ionChange","ionBlur"],[2,"margin-left","5%","border-bottom","solid 1px rgb(56, 128, 255)"],["slot","end","type","number","type","number",3,"value","min","max","ionChange","ionBlur"],["animated","","placeholder","Selecciona un Juego","autocomplete","","autocorrect","",3,"ionInput"],[2,"float","right",3,"click"],["name","add-outline"],["type","submit","expand","block",1,"ion-text-uppercase","ion-margin-top",3,"disabled"]],template:function(i,n){1&i&&(u.TgZ(0,"ion-header"),u.TgZ(1,"ion-toolbar",0),u.TgZ(2,"ion-buttons",1),u._UZ(3,"ion-back-button",2),u.qZA(),u.TgZ(4,"ion-title"),u._uU(5,"Detalles de planificaci\xf3n"),u.qZA(),u.qZA(),u.qZA(),u.TgZ(6,"ion-content"),u.TgZ(7,"ion-row"),u._UZ(8,"ion-col",3),u.TgZ(9,"ion-col"),u.TgZ(10,"ion-title",4),u._uU(11," Detalles "),u.TgZ(12,"ion-button",5),u.NdJ("click",function(){return n.cancelPlanning()}),u._UZ(13,"ion-icon",6),u.TgZ(14,"p",7),u._uU(15,"Eliminar"),u.qZA(),u.qZA(),u.TgZ(16,"ion-button",8),u.NdJ("click",function(){return n.editPlanning()}),u._UZ(17,"ion-icon",9),u.TgZ(18,"p",7),u._uU(19,"Editar"),u.qZA(),u.qZA(),u.qZA(),u.TgZ(20,"form",10),u.NdJ("ngSubmit",function(){return n.edit(n.myForm)}),u.TgZ(21,"ion-item",11),u.TgZ(22,"ion-label",12),u._uU(23,"Paciente"),u.qZA(),u.TgZ(24,"ion-searchbar",13),u.NdJ("ionInput",function(i){return n.filterPatient(i)})("ionFocus",function(){return n.patientBlur=!1})("ionBlur",function(){return n.patientBlur=!0}),u.qZA(),u.TgZ(25,"ion-list",14),u.YNc(26,Z,4,2,"ion-item",15),u.qZA(),u.qZA(),u.YNc(27,f,2,0,"ion-label",16),u.TgZ(28,"ion-item",11),u.TgZ(29,"ion-label",12),u._uU(30,"Nombre de la planificaci\xf3n"),u.qZA(),u._UZ(31,"ion-input",17),u.qZA(),u.TgZ(32,"ion-row"),u.TgZ(33,"ion-col"),u.TgZ(34,"ion-item",18),u.TgZ(35,"ion-label",12),u._uU(36,"Fecha de inicio"),u.qZA(),u.TgZ(37,"ion-input",19),u.NdJ("ionChange",function(){return n.setFinishMinDate()}),u.qZA(),u._UZ(38,"ion-icon",20),u.qZA(),u.qZA(),u.TgZ(39,"ion-col"),u.TgZ(40,"ion-item",18),u.TgZ(41,"ion-label",12),u._uU(42,"Fecha de fin"),u.qZA(),u._UZ(43,"ion-input",21),u._UZ(44,"ion-icon",20),u.qZA(),u.qZA(),u.qZA(),u.YNc(45,x,4,1,"ion-chip",22),u.YNc(46,A,4,1,"ion-chip",23),u.TgZ(47,"ion-item",11),u.TgZ(48,"ion-row"),u.TgZ(49,"ion-col"),u.TgZ(50,"ion-label",12),u._uU(51,"Juegos asignados"),u.qZA(),u.qZA(),u.qZA(),u.qZA(),u.YNc(52,O,2,1,"div",24),u.TgZ(53,"ion-row"),u.TgZ(54,"ion-col"),u.YNc(55,Q,13,4,"ion-card",15),u.qZA(),u.qZA(),u.TgZ(56,"ion-row"),u.TgZ(57,"ion-col"),u.YNc(58,M,6,1,"div",24),u.YNc(59,V,4,0,"ion-button",25),u.qZA(),u.qZA(),u.YNc(60,B,2,1,"ion-button",26),u.qZA(),u.qZA(),u._UZ(61,"ion-col",3),u.qZA(),u.qZA()),2&i&&(u.xp6(16),u.Q6J("disabled",n.isEditing),u.xp6(4),u.Q6J("formGroup",n.myForm),u.xp6(4),u.Q6J("disabled",!0),u.xp6(2),u.Q6J("ngForOf",n.patientsSearch),u.xp6(1),u.Q6J("ngIf",!n.patientExists()&&n.patientBlur),u.xp6(4),u.Q6J("disabled",!n.isEditing),u.xp6(6),u.Q6J("liIonic4Datepicker",n.datePickerStart)("disabled","Pendiente"!=n.state||!n.isEditing),u.xp6(6),u.Q6J("liIonic4Datepicker",n.datePickerFinish)("disabled",!n.isEditing),u.xp6(2),u.Q6J("ngIf","Vigente"===n.state),u.xp6(1),u.Q6J("ngIf","Pendiente"===n.state),u.xp6(6),u.Q6J("ngIf",!n.isEditing),u.xp6(3),u.Q6J("ngForOf",n.planningGames),u.xp6(3),u.Q6J("ngIf",n.isAdding),u.xp6(1),u.Q6J("ngIf",!n.isAdding&&n.isEditing),u.xp6(1),u.Q6J("ngIf",n.isEditing))},directives:[s.Gu,s.sr,s.Sm,s.oU,s.cs,s.wd,s.W2,s.Nd,s.wI,s.YG,s.gu,a._Y,a.JL,a.sg,s.Ie,s.Q$,s.VI,s.j9,a.JJ,a.u,s.q_,t.sg,t.O5,s.pK,o.w5,s.yW,s.hM,s.PM,s.Zi,s.gZ,s.FN,t.RF,t.n9,t.ED,s.yh,s.se,s.QI,s.ho,s.w,s.as,s.B7,s.U5],styles:[""]}),i})()}];let j=(()=>{class i{}return i.\u0275fac=function(n){return new(n||i)},i.\u0275mod=u.oAB({type:i}),i.\u0275inj=u.cJS({imports:[[r.Bz.forChild(H)],r.Bz]}),i})(),z=(()=>{class i{}return i.\u0275fac=function(n){return new(n||i)},i.\u0275mod=u.oAB({type:i}),i.\u0275inj=u.cJS({imports:[[t.ez,a.u5,s.Pc,j,a.UX,o.YZ]]}),i})()}}]);